<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Supply Chain Complexity Assessment</title>
    <meta
      name="description"
      content="Simple tool to compute horizontal, vertical, and combined supply-chain complexity."
    />
    <style>
      :root {
        --bg: #5f83f9;
        --card: #121a33;
        --text: #e7ecf7;
        --muted: #a7b0c2;
        --accent: #69b1ff;
        --ok: #7cf29a;
        --warn: #ffd36e;
        --bad: #ff6b6b;
        --line: #253059;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
        --radius: 18px;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family:
          ui-sans-serif,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Arial;
        background:
          radial-gradient(1200px 700px at 10% -10%, #1e2a5a44, transparent 60%),
          var(--bg);
        color: var(--text);
      }
      .wrap {
        max-width: 980px;
        margin: 40px auto;
        padding: 20px;
      }

      /* Header */
      header {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: 22px;
      }
      .title {
        font-size: clamp(22px, 2.2vw, 28px);
        font-weight: 800;
        letter-spacing: 0.3px;
      }

      /*  Responsive logo layout  */
      .logo-strip {
        display: flex;
        flex-direction: column; /* two rows on mobile */
        gap: 10px;
        padding: 10px 14px;
        background: #e8eaf1;
        border: 1px solid #f0f1f6;
        border-radius: 14px;
        box-shadow: var(--shadow);
      }
      .logo-group {
        display: flex;
        align-items: center;
        justify-content: center; /* centered rows on mobile */
        gap: 14px;
        flex-wrap: nowrap; /* keep partners together per row */
      }
      .logo-group img {
        display: block;
        height: clamp(26px, 3.8vw, 48px);
        width: auto;
        object-fit: contain;
        max-width: 100%;
      }
      .pill {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: #0d1536;
        color: var(--ok);
        font-weight: 700;
        font-size: 13px;
      }

      /* Large screens: one horizontal row (side-by-side) */
      @media (min-width: 900px) {
        .logo-strip {
          flex-direction: row;
          justify-content: flex-start;
          flex-wrap: nowrap;
          gap: 18px;
        }
        .logo-group {
          justify-content: flex-start;
          gap: 18px;
        }
        .logo-group img {
          height: clamp(32px, 2.6vw, 56px);
        }
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 18px;
      }
      .card {
        background: linear-gradient(180deg, #152046, #101733);
        border: 1px solid var(--line);
        border-radius: var(--radius);
        padding: 22px;
        box-shadow: var(--shadow);
      }
      .col-7 {
        grid-column: span 7;
      }
      .col-5 {
        grid-column: span 5;
      }
      @media (max-width: 900px) {
        .col-7,
        .col-5 {
          grid-column: 1/-1;
        }
      }

      label {
        display: block;
        font-weight: 700;
        margin-bottom: 8px;
      }
      .hint {
        color: var(--muted);
        font-size: 14px;
        margin-top: 2px;
      }
      .input {
        width: 100%;
        background: #0c1330;
        border: 1px solid #23305f;
        color: var(--text);
        border-radius: 12px;
        padding: 12px 14px;
        font-size: 16px;
        outline: none;
        transition:
          border 0.15s ease,
          box-shadow 0.15s ease;
      }
      .input:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(105, 177, 255, 0.15);
      }
      .actions {
        display: flex;
        gap: 12px;
        margin-top: 18px;
        flex-wrap: wrap;
      }
      .btn {
        appearance: none;
        border: 1px solid #2a3a6f;
        background: #17214b;
        color: var(--text);
        border-radius: 12px;
        padding: 10px 14px;
        font-weight: 700;
        cursor: pointer;
        transition:
          transform 0.05s ease,
          filter 0.15s ease,
          border 0.15s ease;
      }
      .btn:hover {
        filter: brightness(1.1);
        border-color: var(--accent);
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn.primary {
        background: linear-gradient(180deg, #2a68ff, #1747bd);
        border-color: #2a68ff;
      }
      .btn.ghost {
        background: transparent;
      }

      .kpi {
        background: #0d1536;
        border: 1px solid #273569;
        border-radius: 14px;
        padding: 16px;
      }
      .kpi .label {
        color: var(--muted);
        font-size: 13px;
      }
      .kpi .value {
        font-size: 28px;
        font-weight: 900;
        margin-top: 4px;
      }
      .kpi .ok {
        color: var(--ok);
      }
      .kpi .warn {
        color: var(--warn);
      }
      .kpi .bad {
        color: var(--bad);
      }
      .def {
        margin-top: 6px;
        font-size: 14px;
        color: var(--muted);
      }

      .error {
        color: #ffd5d5;
        background: #2a0f16;
        border: 1px solid #a33;
        padding: 8px 10px;
        border-radius: 10px;
        margin-top: 8px;
        font-size: 14px;
      }
      .sr {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
      .invalid {
        border-color: #ff8a8a !important;
        box-shadow: 0 0 0 3px rgba(255, 106, 106, 0.18) !important;
      }

      footer {
        margin-top: 26px;
        color: var(--muted);
        font-size: 13px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <!-- HEADER (two-row mobile layout, one-row desktop) -->
      <header>
        <div class="logo-strip" role="group" aria-label="Partner logos">
          <!-- Group A: unibz + iNEST + EU -->
          <div class="logo-group">
            <!--<img src="assets/unibz.png" alt="unibz logo" />-->
            <img src="assets/logo-1.png" alt="iNEST logo" />
            <img
              src="assets/logo-2.png"
              alt="Finanziato dall'Unione europea — NextGenerationEU logo"
            />
          </div>
          <!-- Group B: MUR + ItaliaDomani (logo-3 and logo-4 together) -->
          <div class="logo-group">
            <img
              src="assets/logo-3.png"
              alt="Ministero dell'Università e della Ricerca logo"
            />
            <img src="assets/logo-4.png" alt="Italia Domani — PNRR logo" />
          </div>
        </div>

        <div class="title">Supply Chain Complexity Assessment</div>
      </header>

      <!-- ===== MAIN ===== -->
      <div class="grid" role="main">
        <!-- Left: Form -->
        <section class="card col-7" aria-labelledby="formTitle">
          <h2 id="formTitle" class="sr">Input form</h2>

          <form id="complexityForm" novalidate>
            <div
              style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px"
            >
              <div>
                <label for="suppliers">First-tier suppliers</label>
                <div id="supHint" class="hint">
                  How many direct suppliers supply your product?
                </div>
                <input
                  class="input"
                  id="suppliers"
                  name="suppliers"
                  type="number"
                  inputmode="numeric"
                  min="0"
                  step="1"
                  placeholder="e.g., 12"
                  required
                  aria-describedby="supHint supErr"
                />

                <div id="supErr" class="error" hidden></div>
              </div>
              <div>
                <label for="customers">First-tier customers</label>
                <div id="cusHint" class="hint">
                  How many direct customers do you serve?
                </div>
                <input
                  class="input"
                  id="customers"
                  name="customers"
                  type="number"
                  inputmode="numeric"
                  min="0"
                  step="1"
                  placeholder="e.g., 8"
                  required
                  aria-describedby="cusHint cusErr"
                />

                <div id="cusErr" class="error" hidden></div>
              </div>
            </div>

            <!-- Spatial complexity inputs -->
            <div style="margin-top: 16px">
              <div
                style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px"
              >
                <div>
                  <label for="supCountries"
                    >First-tier supplier countries</label
                  >
                  <div id="supCoHint" class="hint">
                    How many countries are your first-tier suppliers located in?
                  </div>
                  <input
                    class="input"
                    id="supCountries"
                    name="supCountries"
                    type="number"
                    inputmode="numeric"
                    min="0"
                    step="1"
                    placeholder="e.g., 5"
                    required
                    aria-describedby="supCoHint supCoErr"
                  />

                  <div id="supCoErr" class="error" hidden></div>
                </div>

                <div>
                  <label for="cusCountries"
                    >First-tier customer countries</label
                  >
                  <div id="cusCoHint" class="hint">
                    How many countries are your first-tier customers located in?
                  </div>
                  <input
                    class="input"
                    id="cusCountries"
                    name="cusCountries"
                    type="number"
                    inputmode="numeric"
                    min="0"
                    step="1"
                    placeholder="e.g., 10"
                    required
                    aria-describedby="cusCoHint cusCoErr"
                  />

                  <div id="cusCoErr" class="error" hidden></div>
                </div>
              </div>
            </div>

            <div style="margin-top: 16px">
              <label for="tiers">Number of tiers (raw → end user)</label>
              <div id="tierHint" class="hint">
                How many supply chain tiers your company have? (≥ 1).
              </div>
              <input
                class="input"
                id="tiers"
                name="tiers"
                type="number"
                inputmode="numeric"
                min="1"
                step="1"
                placeholder="e.g., 4"
                required
                aria-describedby="tierHint tierErr"
              />

              <div id="tierErr" class="error" hidden></div>
            </div>

            <div class="actions">
              <button class="btn primary" type="submit">Calculate</button>
              <button class="btn ghost" type="reset">Reset</button>
              <button class="btn" id="sampleBtn" type="button">
                Use sample data
              </button>
            </div>
          </form>
        </section>

        <!-- Right: Results -->
        <aside class="card col-5" aria-live="polite" aria-atomic="true">
          <h3 style="margin: 0 0 8px 0">Results</h3>
          <div id="resultsEmpty" class="def">
            Enter values and click <b>Calculate</b> to see your metrics.<br />
            <b>Horizontal</b> counts suppliers + customers;
            <b>Vertical</b> equals tiers; <b>Spatial</b> counts supplier
            countries + customer countries.
          </div>
          <div id="results" style="display: none; gap: 12px">
            <div class="kpi">
              <div class="label">Horizontal Complexity (C<sub>h</sub>)</div>
              <div class="value" id="outCh">—</div>
            </div>
            <div class="kpi">
              <div class="label">Vertical Complexity (C<sub>v</sub>)</div>
              <div class="value" id="outCv">—</div>
            </div>
            <div class="kpi">
              <div class="label">Spatial Complexity (S<sub>c</sub>)</div>
              <div class="value" id="outSc">—</div>
            </div>

            <div class="def" id="echo"></div>
            <div style="margin-top: 16px">
              <label for="industry">Benchmark industry</label>
              <select
                class="input"
                id="industry"
                name="industry"
                aria-describedby="indHint"
              >
                <option value="">Select an industry…</option>
                <option>Manufacture of beverages</option>
                <option>Manufacture of tobacco products</option>
                <option>Manufacture of textiles</option>
                <option>Manufacture of wearing apparel</option>
                <option>
                  Manufacture of basic pharmaceutical products and
                  pharmaceutical preparations
                </option>
                <option>Manufacture of rubber and plastic products</option>
                <option>
                  Manufacture of other non-metallic mineral products
                </option>
                <option>Manufacture of basic metals</option>
                <option>Manufacture of furniture</option>
                <option>Other manufacturing</option>
                <option>
                  Repair and installation of machinery and equipment
                </option>
                <option>
                  Fabricated metal products, except machinery and transportation
                  equipments
                </option>
                <option>
                  Electricity, gas, steam and air conditioning supply
                </option>
                <option>
                  Wholesale trade, except of motor vehicles and motorcycles
                </option>
                <option>
                  Rental trade, except motor vehicles and motorcycles
                </option>
                <option>Transportation and warehousing</option>
                <option>Land transport and transport via pipelines</option>
                <option>Programming and broadcasting activities</option>
                <option>
                  Activities of head offices; management consultancy activities
                </option>
              </select>
              <div id="indHint" class="hint">
                Select an industry to view benchmark average complexity
                measures.
              </div>
            </div>

            <div class="actions">
              <button class="btn" id="copyBtn" type="button">
                Copy results
              </button>
            </div>
          </div>
          <!-- Benchmark -->
          <div id="benchmarkBox" style="margin-top: 14px; display: none">
            <h4 style="margin: 0 0 8px 0">Benchmark (industry averages)</h4>

            <div class="kpi" style="margin-bottom: 10px">
              <div class="label">Benchmark Horizontal (C<sub>h</sub>)</div>
              <div class="value" id="bCh">—</div>
            </div>

            <div class="kpi" style="margin-bottom: 10px">
              <div class="label">Benchmark Vertical (C<sub>v</sub>)</div>
              <div class="value" id="bCv">—</div>
            </div>

            <div class="kpi">
              <div class="label">Benchmark Spatial (S<sub>c</sub>)</div>
              <div class="value" id="bSc">—</div>
            </div>

            <div class="def" id="bIndustry" style="margin-top: 8px"></div>
          </div>

          <div
            id="copyToast"
            class="pill"
            style="margin-top: 10px; display: none"
          >
            Copied!
          </div>
        </aside>
      </div>

      <footer>
        <div>
          © <span id="year"></span> • SCAssessmentTool/iNEST Project
          Funding/Young Research/UNIBZ
        </div>

        <div>
          Contact:
          <a
            href="mailto:mteshome@unibz.it?subject=Support%20request&body=Hi%2C%0A%0AWe%27re%20using%20the%20complexity%20tool..."
            >mteshome@unibz.it
          </a>
        </div>
      </footer>
    </div>

    <script>
      const $ = (sel) => document.querySelector(sel);
      const form = $("#complexityForm");
      const fields = {
        suppliers: {
          el: $("#suppliers"),
          err: $("#supErr"),
          min: 0,
          label: "First-tier suppliers",
        },
        customers: {
          el: $("#customers"),
          err: $("#cusErr"),
          min: 0,
          label: "First-tier customers",
        },

        supCountries: {
          el: $("#supCountries"),
          err: $("#supCoErr"),
          min: 0,
          label: "First-tier supplier countries",
        },
        cusCountries: {
          el: $("#cusCountries"),
          err: $("#cusCoErr"),
          min: 0,
          label: "First-tier customer countries",
        },
        tiers: { el: $("#tiers"), err: $("#tierErr"), min: 1, label: "Tiers" },
      };
      const resultsBox = $("#results");
      const resultsEmpty = $("#resultsEmpty");
      const outCh = $("#outCh"),
        outCv = $("#outCv"),
        outSc = $("#outSc"),
        echo = $("#echo");

      const copyBtn = $("#copyBtn"),
        toast = $("#copyToast");
      const sampleBtn = $("#sampleBtn");
      const industrySel = $("#industry");
      const benchmarkBox = $("#benchmarkBox");
      const bCh = $("#bCh"),
        bCv = $("#bCv"),
        bSc = $("#bSc"),
        bIndustry = $("#bIndustry");

      document.getElementById("year").textContent = new Date().getFullYear();
      const BENCHMARKS = {
        "Manufacture of beverages": { Ch: "71.50", Cv: "99.82", Sc: "30.25" },
        "Manufacture of tobacco products": {
          Ch: "131.62",
          Cv: "165.39",
          Sc: "46.84",
        },
        "Manufacture of textiles": { Ch: "194.65", Cv: "280.91", Sc: "64.43" },
        "Manufacture of wearing apparel": {
          Ch: "214.59",
          Cv: "240.91",
          Sc: "59.71",
        },
        "Manufacture of basic pharmaceutical products and pharmaceutical preparations":
          {
            Ch: "138.18",
            Cv: "128.09",
            Sc: "47.90",
          },
        "Manufacture of rubber and plastic products": {
          Ch: "84.93",
          Cv: "147.01",
          Sc: "36.16",
        },
        "Manufacture of other non-metallic mineral products": {
          Ch: "80.87",
          Cv: "179.97",
          Sc: "38.73",
        },
        "Manufacture of basic metals": {
          Ch: "117.27",
          Cv: "203.70",
          Sc: "48.52",
        },
        "Manufacture of furniture": { Ch: "117.25", Cv: "122.67", Sc: "43.86" },
        "Other manufacturing": { Ch: "113.77", Cv: "197.32", Sc: "33.69" },
        "Repair and installation of machinery and equipment": {
          Ch: "149.20",
          Cv: "296.93",
          Sc: "40.76",
        },
        "Fabricated metal products, except machinery and transportation equipments":
          {
            Ch: "112.65",
            Cv: "242.71",
            Sc: "41.28",
          },
        "Electricity, gas, steam and air conditioning supply": {
          Ch: "168.06",
          Cv: "325.96",
          Sc: "47.70",
        },
        "Wholesale trade, except of motor vehicles and motorcycles": {
          Ch: "147.9",
          Cv: "203.34",
          Sc: "65.90",
        },
        "Rental trade, except motor vehicles and motorcycles": {
          Ch: "116.83",
          Cv: "205.44",
          Sc: "42.95",
        },
        "Transportation and warehousing": {
          Ch: "74.80",
          Cv: "124.87",
          Sc: "28.97",
        },
        "Land transport and transport via pipelines": {
          Ch: "253.27",
          Cv: "360.60",
          Sc: "82.73",
        },
        "Programming and broadcasting activities": {
          Ch: "24.44",
          Cv: "95.54",
          Sc: "12.58",
        },
        "Activities of head offices; management consultancy activities": {
          Ch: "471.375",
          Cv: "116.12",
          Sc: "72.00",
        },
      };

      function parseIntStrict(inputEl, min, label, errEl) {
        const raw = inputEl.value.trim();
        let msg = "";
        if (raw === "") msg = `${label} is required.`;
        const num = Number(raw);
        if (!msg && (!Number.isFinite(num) || !Number.isInteger(num)))
          msg = `${label} must be an integer.`;
        if (!msg && num < min) msg = `${label} must be ≥ ${min}.`;

        if (msg) {
          inputEl.classList.add("invalid");
          inputEl.setAttribute("aria-invalid", "true");
          errEl.hidden = false;
          errEl.textContent = msg;
          return { ok: false };
        } else {
          inputEl.classList.remove("invalid");
          inputEl.removeAttribute("aria-invalid");
          errEl.hidden = true;
          errEl.textContent = "";
          return { ok: true, value: num };
        }
      }

      function renderBenchmark() {
        const key = industrySel.value.trim();
        if (!key || !BENCHMARKS[key]) {
          benchmarkBox.style.display = "none";
          bCh.textContent = "—";
          bCv.textContent = "—";
          bSc.textContent = "—";
          bIndustry.textContent = "";
          return;
        }

        const m = BENCHMARKS[key];
        benchmarkBox.style.display = "block";
        bCh.textContent = m.Ch;
        bCv.textContent = m.Cv;
        bSc.textContent = m.Sc;
        bIndustry.textContent = `Industry: ${key}`;
      }

      industrySel.addEventListener("change", renderBenchmark);

      function compute() {
        const s = parseIntStrict(
          fields.suppliers.el,
          fields.suppliers.min,
          fields.suppliers.label,
          fields.suppliers.err,
        );
        const c = parseIntStrict(
          fields.customers.el,
          fields.customers.min,
          fields.customers.label,
          fields.customers.err,
        );
        const scSup = parseIntStrict(
          fields.supCountries.el,
          fields.supCountries.min,
          fields.supCountries.label,
          fields.supCountries.err,
        );
        const scCus = parseIntStrict(
          fields.cusCountries.el,
          fields.cusCountries.min,
          fields.cusCountries.label,
          fields.cusCountries.err,
        );
        const t = parseIntStrict(
          fields.tiers.el,
          fields.tiers.min,
          fields.tiers.label,
          fields.tiers.err,
        );

        if (!s.ok || !c.ok || !scSup.ok || !scCus.ok || !t.ok) {
          resultsBox.style.display = "none";
          resultsEmpty.style.display = "block";
          return;
        }

        const Ch = s.value + c.value;
        const Cv = t.value;
        const Sc = scSup.value + scCus.value;

        outCh.textContent = Ch;
        outCv.textContent = Cv;
        outSc.textContent = Sc;

        echo.innerHTML =
          `Inputs → suppliers: <b>${s.value}</b>, customers: <b>${c.value}</b>, ` +
          `supplier countries: <b>${scSup.value}</b>, customer countries: <b>${scCus.value}</b>, ` +
          `tiers: <b>${t.value}</b>.`;

        resultsEmpty.style.display = "none";
        resultsBox.style.display = "grid";
      }

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        compute();
        const firstInvalid = form.querySelector(".invalid");
        if (firstInvalid) firstInvalid.focus();
      });

      form.addEventListener("reset", () => {
        setTimeout(() => {
          Object.values(fields).forEach(({ el, err }) => {
            el.classList.remove("invalid");
            el.removeAttribute("aria-invalid");
            err.hidden = true;
            err.textContent = "";
          });
          resultsBox.style.display = "none";
          resultsEmpty.style.display = "block";

          // Reset benchmark selection + UI
          industrySel.value = "";
          renderBenchmark();
        }, 0);
      });

      // Live update as users type
      Object.values(fields).forEach(({ el }) =>
        el.addEventListener("input", () => {
          if (Object.values(fields).every(({ el }) => el.value.trim() !== ""))
            compute();
        }),
      );

      copyBtn.addEventListener("click", async () => {
        const selectedIndustry = industrySel.value.trim();
        const bench =
          selectedIndustry && BENCHMARKS[selectedIndustry]
            ? BENCHMARKS[selectedIndustry]
            : null;

        const payload = {
          Ch: Number(outCh.textContent || 0),
          Cv: Number(outCv.textContent || 0),
          Sc: Number(outSc.textContent || 0),
          inputs: {
            suppliers: Number(fields.suppliers.el.value || 0),
            customers: Number(fields.customers.el.value || 0),
            supplierCountries: Number(fields.supCountries.el.value || 0),
            customerCountries: Number(fields.cusCountries.el.value || 0),
            tiers: Number(fields.tiers.el.value || 0),
            industry: selectedIndustry || null,
          },
          benchmark: bench
            ? {
                industry: selectedIndustry,
                Ch: Number(bench.Ch),
                Cv: Number(bench.Cv),
                Sc: Number(bench.Sc),
              }
            : null,
        };

        try {
          await navigator.clipboard.writeText(JSON.stringify(payload, null, 2));
          toast.textContent = "Copied!";
          toast.style.display = "inline-block";
          setTimeout(() => (toast.style.display = "none"), 1200);
        } catch (e) {
          alert("Copy failed. You can copy the values manually.");
        }
      });

      sampleBtn.addEventListener("click", () => {
        fields.suppliers.el.value = 12;
        fields.customers.el.value = 8;
        fields.supCountries.el.value = 5;
        fields.cusCountries.el.value = 3;
        fields.tiers.el.value = 4;
        compute();
      });
    </script>
  </body>
</html>
